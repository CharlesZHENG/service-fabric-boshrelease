---
name: azure-service-fabric

instance_groups:
- name: service-fabric
  azs: [z1,z2,z3]
  instances: 5
  vm_type: service-fabric
  stemcell: default
  networks: [{name: service-fabric}]
  env:
    bosh:
      ipv6: {enable: true}
      swap_size: 0
  jobs:
  - name: service-fabric
    release: azure-service-fabric
    properties:
      PrimaryAccountNTLMPasswordSecret: ((PrimaryAccountNTLMPasswordSecret))
      SecondaryAccountNTLMPasswordSecret: ((SecondaryAccountNTLMPasswordSecret))
  - name: repair
    release: azure-service-fabric
    properties: {}

- name: smoke-test
  azs: [z1]
  instances: 1
  lifecycle: errand
  vm_type: small
  stemcell: default
  networks: [{name: service-fabric}]
  env:
    bosh:
      ipv6: {enable: true}
  jobs:
  - name: smoke-test
    release: azure-service-fabric

- name: upgrade
  azs: [z1]
  instances: 1
  lifecycle: errand
  vm_type: small
  stemcell: default
  networks: [{name: service-fabric}]
  env:
    bosh:
      ipv6: {enable: true}
  jobs:
  - name: upgrade
    release: azure-service-fabric

variables:
- name: PrimaryAccountNTLMPasswordSecret
  type: password
- name: SecondaryAccountNTLMPasswordSecret
  type: password

stemcells:
- alias: default
  os: ubuntu-xenial
  version: 97.16

update:
  canaries: 5
  max_in_flight: 1
  canary_watch_time: 1000-10000
  update_watch_time: 1000-10000
  serial: false

releases:
- name: azure-service-fabric
  version: latest
